<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>–¢–µ–Ω–∏ –°–æ–∑–Ω–∞–Ω–∏—è | –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #000;
            color: #e0e0e0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: fixed;
            touch-action: manipulation;
        }

        /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0a0a0a, #1a1a2e, #16213e, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -1;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* –ß–∞—Å—Ç–∏—Ü—ã —Å—Ç—Ä–∞—Ö–∞ */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(255, 0, 102, 0.5);
            border-radius: 50%;
            animation: float 10s infinite;
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0) translateX(0);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-100vh) translateX(50px);
                opacity: 0;
            }
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã */
        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            z-index: 10;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        #top-bar {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 2px solid #ff0066;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(26, 26, 46, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #444;
            font-size: 0.9em;
            flex: 1;
            min-width: 100px;
            justify-content: center;
        }

        .stat-icon {
            font-size: 1.2em;
        }

        .stat-value {
            font-weight: bold;
            color: #00ff88;
        }

        /* –®–∫–∞–ª–∞ —Ç—Ä–µ–≤–æ–≥–∏ */
        .anxiety-bar {
            width: 100%;
            height: 5px;
            background: rgba(0, 0, 0, 0.8);
            position: relative;
            overflow: hidden;
        }

        .anxiety-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #ffaa00, #ff0066, #ff0000);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px currentColor;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        #content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* –≠–∫—Ä–∞–Ω—ã */
        .screen {
            display: none;
            width: 100%;
            max-width: 600px;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é */
        #menu-screen {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            border: 2px solid #ff0066;
            box-shadow: 0 0 30px rgba(255, 0, 102, 0.3);
        }

        .game-title {
            font-size: clamp(1.8em, 5vw, 3em);
            color: #ff0066;
            text-shadow: 0 0 20px #ff0066;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        .game-subtitle {
            font-size: clamp(0.9em, 3vw, 1.2em);
            color: #999;
            margin-bottom: 30px;
            font-style: italic;
        }

        .menu-description {
            font-size: clamp(0.8em, 2.5vw, 1em);
            line-height: 1.6;
            margin-bottom: 30px;
            color: #ccc;
            padding: 15px;
            background: rgba(255, 0, 102, 0.1);
            border-radius: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 15px 30px;
            font-size: clamp(1em, 3vw, 1.2em);
            background: linear-gradient(135deg, #ff0066, #ff3388);
            border: none;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 0;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 5px 15px rgba(255, 0, 102, 0.4);
            touch-action: manipulation;
        }

        .btn:hover, .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(255, 0, 102, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #444, #666);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .btn-secondary:hover, .btn-secondary:active {
            box-shadow: 0 7px 20px rgba(0, 0, 0, 0.6);
        }

        /* –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
        #game-screen {
            padding: 20px;
        }

        .level-indicator {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            border: 2px solid #00ff88;
        }

        .level-title {
            font-size: clamp(1.2em, 4vw, 1.8em);
            color: #00ff88;
            margin-bottom: 5px;
        }

        .level-subtitle {
            font-size: clamp(0.8em, 2.5vw, 1em);
            color: #999;
        }

        /* –°—Ü–µ–Ω–∞—Ä–∏–π */
        .scenario-box {
            background: rgba(0, 0, 0, 0.9);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #ff0066;
            margin-bottom: 25px;
            min-height: 150px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .scenario-text {
            font-size: clamp(1em, 3vw, 1.2em);
            line-height: 1.8;
            color: #e0e0e0;
            animation: typeIn 1s ease;
        }

        @keyframes typeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* –í—ã–±–æ—Ä—ã */
        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice {
            padding: 18px;
            background: rgba(30, 30, 30, 0.9);
            border: 2px solid #555;
            border-radius: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: clamp(0.9em, 2.5vw, 1.1em);
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }

        .choice::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .choice:hover::before, .choice:active::before {
            left: 100%;
        }

        .choice:hover, .choice:active {
            background: rgba(50, 50, 50, 0.9);
            border-color: #00ff88;
            transform: translateX(5px);
        }

        .choice.dangerous:hover, .choice.dangerous:active {
            border-color: #ff0066;
            box-shadow: 0 0 15px rgba(255, 0, 102, 0.5);
        }

        .choice-icon {
            margin-right: 10px;
            font-size: 1.2em;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
        #result-screen {
            text-align: center;
            padding: 30px 20px;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 15px;
        }

        .result-title {
            font-size: clamp(1.5em, 5vw, 2.5em);
            margin-bottom: 20px;
            color: #ff0066;
            text-shadow: 0 0 20px #ff0066;
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .result-stat {
            padding: 20px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            border: 2px solid #444;
        }

        .result-stat-value {
            font-size: clamp(1.8em, 5vw, 2.5em);
            font-weight: bold;
            color: #00ff88;
            margin-bottom: 5px;
        }

        .result-stat-label {
            font-size: clamp(0.8em, 2.5vw, 1em);
            color: #999;
        }

        .result-message {
            font-size: clamp(1em, 3vw, 1.3em);
            line-height: 1.8;
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 0, 102, 0.1);
            border-radius: 10px;
            border: 1px solid #ff0066;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Ç—Ä—è—Å–∫–∏ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –∑–∞—Ç–µ–º–Ω–µ–Ω–∏—è */
        .darken {
            animation: darken 0.3s ease;
        }

        @keyframes darken {
            0% { filter: brightness(1); }
            50% { filter: brightness(0.3); }
            100% { filter: brightness(1); }
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è */
        @media (max-width: 768px) {
            #top-bar {
                padding: 8px 10px;
            }

            .stat-box {
                padding: 6px 10px;
                font-size: 0.8em;
                min-width: 80px;
            }

            #content {
                padding: 15px;
            }

            .scenario-box {
                padding: 18px;
                min-height: 120px;
            }

            .choice {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .stat-box {
                flex: 1 1 calc(50% - 10px);
            }
        }

        /* –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-height: 500px) and (orientation: landscape) {
            #content {
                padding: 10px;
            }

            .scenario-box {
                padding: 15px;
                min-height: 80px;
            }

            .level-indicator {
                padding: 10px;
                margin-bottom: 10px;
            }

            .choices {
                gap: 10px;
            }

            .choice {
                padding: 12px;
            }
        }

        /* –ü—É–ª—å—Å–∏—Ä—É—é—â–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ */
        .critical-glow {
            animation: criticalGlow 1s infinite;
        }

        @keyframes criticalGlow {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            }
            50% { 
                box-shadow: 0 0 30px rgba(255, 0, 0, 0.9);
            }
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            text-align: center;
            padding: 20px;
            color: #999;
            font-style: italic;
        }

        /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        .achievement-popup {
            position: fixed;
            top: 80px;
            right: -350px;
            background: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00ff88;
            z-index: 1000;
            transition: right 0.5s ease;
            max-width: 300px;
        }

        .achievement-popup.show {
            right: 20px;
        }

        .achievement-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .achievement-title {
            color: #00ff88;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-text {
            font-size: 0.9em;
            color: #ccc;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å —É—Ä–æ–≤–Ω—è */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0066, #00ff88);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px currentColor;
        }
    </style>
</head>
<body>
    <div class="animated-bg"></div>
    <div class="particles" id="particles"></div>
    
    <div id="game-container">
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div id="top-bar">
            <div class="stat-box">
                <span class="stat-icon">üéØ</span>
                <span>–£—Ä–æ–≤–µ–Ω—å: <span class="stat-value" id="current-level">1</span></span>
            </div>
            <div class="stat-box">
                <span class="stat-icon">‚≠ê</span>
                <span>–ë–∞–ª–ª—ã: <span class="stat-value" id="score">0</span></span>
            </div>
            <div class="stat-box">
                <span class="stat-icon">üíé</span>
                <span>–†–µ—à–µ–Ω–∏–π: <span class="stat-value" id="decisions">0</span></span>
            </div>
        </div>
        
        <!-- –®–∫–∞–ª–∞ —Ç—Ä–µ–≤–æ–≥–∏ -->
        <div class="anxiety-bar">
            <div class="anxiety-fill" id="anxiety-fill" style="width: 0%"></div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div id="content">
            <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
            <div id="menu-screen" class="screen active">
                <h1 class="game-title">üé≠ –¢–ï–ù–ò –°–û–ó–ù–ê–ù–ò–Ø</h1>
                <p class="game-subtitle">–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç—Ä–∏–ª–ª–µ—Ä</p>
                <div class="menu-description">
                    –ü–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ –º–∏—Ä –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä–∞—Ö–æ–≤ –∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π. 
                    –ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–µ—Ç –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è. –ö–∞–∂–¥—ã–π –≤—ã–±–æ—Ä –º–µ–Ω—è–µ—Ç –≤–∞—Å.
                    –°–º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—Å—É–¥–æ–∫ –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑—É–º–∞?
                </div>
                <button class="btn" onclick="game.startGame()">
                    üéÆ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É
                </button>
                <button class="btn btn-secondary" onclick="game.showRules()">
                    üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
                </button>
                <button class="btn btn-secondary" onclick="game.showStats()">
                    üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </button>
            </div>

            <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
            <div id="game-screen" class="screen">
                <div class="level-indicator">
                    <div class="level-title" id="level-title">–£—Ä–æ–≤–µ–Ω—å 1</div>
                    <div class="level-subtitle" id="level-subtitle">–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div class="scenario-box">
                    <div class="scenario-text" id="scenario-text">
                        –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è...
                    </div>
                </div>

                <div class="choices" id="choices">
                    <!-- –í—ã–±–æ—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="result-screen" class="screen">
                <h2 class="result-title" id="result-title">–ö–æ–Ω–µ—Ü –∏–≥—Ä—ã</h2>
                
                <div class="result-stats">
                    <div class="result-stat">
                        <div class="result-stat-value" id="final-score">0</div>
                        <div class="result-stat-label">–ë–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="result-stat">
                        <div class="result-stat-value" id="final-level">0</div>
                        <div class="result-stat-label">–£—Ä–æ–≤–Ω–µ–π</div>
                    </div>
                    <div class="result-stat">
                        <div class="result-stat-value" id="final-decisions">0</div>
                        <div class="result-stat-label">–†–µ—à–µ–Ω–∏–π</div>
                    </div>
                    <div class="result-stat">
                        <div class="result-stat-value" id="final-anxiety">0%</div>
                        <div class="result-stat-label">–¢—Ä–µ–≤–æ–≥–∏</div>
                    </div>
                </div>

                <div class="result-message" id="result-message">
                    –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç...
                </div>

                <button class="btn" onclick="game.restartGame()">
                    üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
                </button>
                <button class="btn btn-secondary" onclick="game.backToMenu()">
                    üè† –í –º–µ–Ω—é
                </button>
            </div>
        </div>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
    <div class="achievement-popup" id="achievement-popup">
        <div class="achievement-icon" id="achievement-icon">üèÜ</div>
        <div class="achievement-title" id="achievement-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!</div>
        <div class="achievement-text" id="achievement-text"></div>
    </div>

    <script>
        // –ì–ª–∞–≤–Ω—ã–π –æ–±—ä–µ–∫—Ç –∏–≥—Ä—ã
        const game = {
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            state: {
                currentLevel: 1,
                score: 0,
                anxiety: 0,
                decisions: 0,
                currentScenarioIndex: 0,
                gameActive: false,
                maxLevels: 10
            },

            // –ë–∞–∑–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
            scenarios: [
                // –£—Ä–æ–≤–µ–Ω—å 1: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ
                {
                    level: 1,
                    title: "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ",
                    subtitle: "–¢—É–º–∞–Ω–Ω–æ–µ —É—Ç—Ä–æ",
                    text: "–í—ã –ø—Ä–æ—Å—ã–ø–∞–µ—Ç–µ—Å—å –≤ –Ω–µ–∑–Ω–∞–∫–æ–º–æ–π –∫–æ–º–Ω–∞—Ç–µ. –°—Ç–µ–Ω—ã –ø–æ–∫—Ä—ã—Ç—ã —Å—Ç—Ä–∞–Ω–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏. –ó–∞ –æ–∫–Ω–æ–º –≥—É—Å—Ç–æ–π —Ç—É–º–∞–Ω. –¢–µ–ª–µ—Ñ–æ–Ω –Ω–∞ —Å—Ç–æ–ª–µ –º–∏–≥–∞–µ—Ç —Ç—Ä–µ–≤–æ–∂–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏. –ß—Ç–æ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ?",
                    choices: [
                        { text: "üì± –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è", anxiety: 10, score: 10, icon: "üì±" },
                        { text: "üö™ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–π—Ç–∏ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã", anxiety: 20, score: 5, icon: "üö™", dangerous: true },
                        { text: "üîç –ò–∑—É—á–∏—Ç—å —Å–∏–º–≤–æ–ª—ã –Ω–∞ —Å—Ç–µ–Ω–∞—Ö", anxiety: 5, score: 20, icon: "üîç" },
                        { text: "ü™ü –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –æ–∫–Ω–æ", anxiety: 15, score: 15, icon: "ü™ü" }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 2: –ö–æ—Ä–∏–¥–æ—Ä —Ç–µ–Ω–µ–π
                {
                    level: 2,
                    title: "–ö–æ—Ä–∏–¥–æ—Ä —Ç–µ–Ω–µ–π",
                    subtitle: "–¢–µ–Ω–∏ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö",
                    text: "–í—ã –æ–∫–∞–∑—ã–≤–∞–µ—Ç–µ—Å—å –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º –∫–æ—Ä–∏–¥–æ—Ä–µ. –ù–∞ —Å—Ç–µ–Ω–∞—Ö –ø–ª—è—à—É—Ç —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Ç–µ–Ω–∏, —Ö–æ—Ç—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–≤–µ—Ç–∞ –Ω–µ –≤–∏–¥–Ω–æ. –°–ª—ã—à–Ω—ã —à–∞–≥–∏... –∏–ª–∏ —ç—Ç–æ —ç—Ö–æ –≤–∞—à–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö?",
                    choices: [
                        { text: "üèÉ –ü–æ–±–µ–∂–∞—Ç—å –≤–ø–µ—Ä—ë–¥", anxiety: 25, score: 10, icon: "üèÉ", dangerous: true },
                        { text: "üïØÔ∏è –ó–∞–∂–µ—á—å —Å–ø–∏—á–∫—É", anxiety: 10, score: 25, icon: "üïØÔ∏è" },
                        { text: "üëÇ –ü—Ä–∏—Å–ª—É—à–∞—Ç—å—Å—è –∫ –∑–≤—É–∫–∞–º", anxiety: 15, score: 20, icon: "üëÇ" },
                        { text: "ü§ö –ö–æ—Å–Ω—É—Ç—å—Å—è —Ç–µ–Ω–∏", anxiety: 30, score: 30, icon: "ü§ö", dangerous: true }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 3: –ó–µ—Ä–∫–∞–ª—å–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞
                {
                    level: 3,
                    title: "–ó–µ—Ä–∫–∞–ª—å–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞",
                    subtitle: "–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ç—Ä–∞–∂–µ–Ω–∏–π",
                    text: "–ö–æ–º–Ω–∞—Ç–∞ –ø–æ–ª–Ω–∞ –∑–µ—Ä–∫–∞–ª. –í–∞—à–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–Ω–æ —É–ª—ã–±–∞–µ—Ç—Å—è, —Ö–æ—Ç—è –≤—ã —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç–µ. –û–¥–Ω–æ –∏–∑ –æ—Ç—Ä–∞–∂–µ–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–µ –º–µ—Å—Ç–æ...",
                    choices: [
                        { text: "üëÅÔ∏è –°–º–æ—Ç—Ä–µ—Ç—å –≤ —Å–≤–æ—ë –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ", anxiety: 20, score: 15, icon: "üëÅÔ∏è" },
                        { text: "üî® –†–∞–∑–±–∏—Ç—å –±–ª–∏–∂–∞–π—à–µ–µ –∑–µ—Ä–∫–∞–ª–æ", anxiety: 35, score: 25, icon: "üî®", dangerous: true },
                        { text: "üö∂ –ò–¥—Ç–∏ –∫ —Å—Ç—Ä–∞–Ω–Ω–æ–º—É –æ—Ç—Ä–∞–∂–µ–Ω–∏—é", anxiety: 25, score: 30, icon: "üö∂" },
                        { text: "üôà –ó–∞–∫—Ä—ã—Ç—å –≥–ª–∞–∑–∞ –∏ –∏–¥—Ç–∏ –Ω–∞–æ—â—É–ø—å", anxiety: 40, score: 40, icon: "üôà", dangerous: true }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 4: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞–±—ã—Ç—ã—Ö —Å–ª–æ–≤
                {
                    level: 4,
                    title: "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞",
                    subtitle: "–ö–Ω–∏–≥–∏ –±–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏–π",
                    text: "–í—ã –≤ –æ–≥—Ä–æ–º–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ. –ö–Ω–∏–≥–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º —è–∑—ã–∫–µ. –û–¥–Ω–∞ –∫–Ω–∏–≥–∞ —Å–≤–µ—Ç–∏—Ç—Å—è –≤ —Ç–µ–º–Ω–æ—Ç–µ. –ù–∞ —Å—Ç–æ–ª–µ –ª–µ–∂–∏—Ç –ø–∏—Å—å–º–æ —Å –≤–∞—à–∏–º –∏–º–µ–Ω–µ–º...",
                    choices: [
                        { text: "üìñ –û—Ç–∫—Ä—ã—Ç—å —Å–≤–µ—Ç—è—â—É—é—Å—è –∫–Ω–∏–≥—É", anxiety: 30, score: 35, icon: "üìñ", dangerous: true },
                        { text: "‚úâÔ∏è –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ø–∏—Å—å–º–æ", anxiety: 15, score: 20, icon: "‚úâÔ∏è" },
                        { text: "üî¶ –ò—Å–∫–∞—Ç—å –≤—ã—Ö–æ–¥ —Å —Ñ–æ–Ω–∞—Ä—ë–º", anxiety: 20, score: 25, icon: "üî¶" },
                        { text: "ü™ë –°–µ—Å—Ç—å –∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å", anxiety: 10, score: 15, icon: "ü™ë" }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 5: –õ–µ—Å—Ç–Ω–∏—Ü–∞ —Ä–µ—à–µ–Ω–∏–π
                {
                    level: 5,
                    title: "–õ–µ—Å—Ç–Ω–∏—Ü–∞",
                    subtitle: "–í–≤–µ—Ä—Ö –∏–ª–∏ –≤–Ω–∏–∑?",
                    text: "–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –ª–µ—Å—Ç–Ω–∏—Ü–∞. –í–≤–µ—Ä—Ö –≤–µ–¥—ë—Ç –∫ —Å–≤–µ—Ç—É, –Ω–æ —Å–ª—ã—à–Ω—ã –∫—Ä–∏–∫–∏. –í–Ω–∏–∑ - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–µ–º–Ω–æ—Ç–∞ –∏ —Ç–∏—à–∏–Ω–∞. –ü–æ—Å–µ—Ä–µ–¥–∏–Ω–µ –¥–≤–µ—Ä—å —Å –Ω–∞–¥–ø–∏—Å—å—é '–ù–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å'.",
                    choices: [
                        { text: "‚¨ÜÔ∏è –ü–æ–¥–Ω—è—Ç—å—Å—è –∫ —Å–≤–µ—Ç—É", anxiety: 25, score: 30, icon: "‚¨ÜÔ∏è" },
                        { text: "‚¨áÔ∏è –°–ø—É—Å—Ç–∏—Ç—å—Å—è –≤ —Ç–µ–º–Ω–æ—Ç—É", anxiety: 40, score: 40, icon: "‚¨áÔ∏è", dangerous: true },
                        { text: "üö™ –û—Ç–∫—Ä—ã—Ç—å –∑–∞–ø—Ä–µ—Ç–Ω—É—é –¥–≤–µ—Ä—å", anxiety: 50, score: 50, icon: "üö™", dangerous: true },
                        { text: "üßò –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ –º–µ—Å—Ç–µ –∏ –º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å", anxiety: -10, score: 20, icon: "üßò" }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 6: –ö–æ–º–Ω–∞—Ç–∞ –≤—ã–±–æ—Ä–æ–≤
                {
                    level: 6,
                    title: "–í—ã–±–æ—Ä",
                    subtitle: "–¶–µ–Ω–∞ —Ä–µ—à–µ–Ω–∏–π",
                    text: "–í—ã –≤ –∫–æ–º–Ω–∞—Ç–µ —Å —Ç—Ä–µ–º—è –¥–≤–µ—Ä—è–º–∏. –ù–∞–¥ –ø–µ—Ä–≤–æ–π –Ω–∞–ø–∏—Å–∞–Ω–æ '–ò—Å—Ç–∏–Ω–∞', –Ω–∞–¥ –≤—Ç–æ—Ä–æ–π '–õ–æ–∂—å', –Ω–∞–¥ —Ç—Ä–µ—Ç—å–µ–π '–ó–∞–±–≤–µ–Ω–∏–µ'. –ß–µ—Ç–≤—ë—Ä—Ç–∞—è –¥–≤–µ—Ä—å –±–µ–∑ –Ω–∞–¥–ø–∏—Å–∏ –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è...",
                    choices: [
                        { text: "‚ú® –ò—Å—Ç–∏–Ω–∞", anxiety: 30, score: 45, icon: "‚ú®" },
                        { text: "üé≠ –õ–æ–∂—å", anxiety: 25, score: 35, icon: "üé≠" },
                        { text: "üå´Ô∏è –ó–∞–±–≤–µ–Ω–∏–µ", anxiety: 20, score: 25, icon: "üå´Ô∏è" },
                        { text: "‚ùì –í–æ–π—Ç–∏ –≤ –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é—Å—è –¥–≤–µ—Ä—å", anxiety: 45, score: 55, icon: "‚ùì", dangerous: true }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 7: –°–∞–¥ –ø–∞–º—è—Ç–∏
                {
                    level: 7,
                    title: "–°–∞–¥ –ø–∞–º—è—Ç–∏",
                    subtitle: "–ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª—å–Ω—ã–º?",
                    text: "–í—ã –≤ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–º —Å–∞–¥—É. –ö–∞–∂–¥—ã–π —Ü–≤–µ—Ç–æ–∫ - —ç—Ç–æ –≤–∞—à–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ü–≤–µ—Ç—ã —É–≤—è–¥–∞—é—Ç. –°–∞–¥–æ–≤–Ω–∏–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º –≤—ã–±—Ä–∞—Ç—å, –∫–∞–∫–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å...",
                    choices: [
                        { text: "üåπ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã", anxiety: 15, score: 30, icon: "üåπ" },
                        { text: "ü•Ä –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏", anxiety: 35, score: 50, icon: "ü•Ä", dangerous: true },
                        { text: "üå∫ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è", anxiety: 25, score: 40, icon: "üå∫" },
                        { text: "üî• –°–∂–µ—á—å –≤—Å–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è", anxiety: 55, score: 60, icon: "üî•", dangerous: true }
                    ]
                },
                                // –£—Ä–æ–≤–µ–Ω—å 8: –ó–∞–ª —ç–º–æ—Ü–∏–π
                {
                    level: 8,
                    title: "–ó–∞–ª —ç–º–æ—Ü–∏–π",
                    subtitle: "–ß—É–≤—Å—Ç–≤–∞ –æ–≤–µ—â–µ—Å—Ç–≤–ª—ë–Ω–Ω—ã–µ",
                    text: "–û–≥—Ä–æ–º–Ω—ã–π –∑–∞–ª, –≥–¥–µ —ç–º–æ—Ü–∏–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–ª–∏—Å—å. –°—Ç—Ä–∞—Ö - —Ç—ë–º–Ω–∞—è —Ç–µ–Ω—å –≤ —É–≥–ª—É. –†–∞–¥–æ—Å—Ç—å - —è—Ä–∫–∏–π —Å–≤–µ—Ç —É –ø–æ—Ç–æ–ª–∫–∞. –ì–Ω–µ–≤ - –∫—Ä–∞—Å–Ω–æ–µ –ø–ª–∞–º—è. –ü–µ—á–∞–ª—å - —Å–∏–Ω–∏–π —Ç—É–º–∞–Ω. –ß—Ç–æ –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ?",
                    choices: [
                        { text: "üò® –ü—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è—Ç—å —Å—Ç—Ä–∞—Ö—É", anxiety: 40, score: 60, icon: "üò®", dangerous: true },
                        { text: "üòä –û–±–Ω—è—Ç—å —Ä–∞–¥–æ—Å—Ç—å", anxiety: 10, score: 35, icon: "üòä" },
                        { text: "üò§ –£–∫—Ä–æ—Ç–∏—Ç—å –≥–Ω–µ–≤", anxiety: 50, score: 65, icon: "üò§", dangerous: true },
                        { text: "üò¢ –ü—Ä–∏–Ω—è—Ç—å –ø–µ—á–∞–ª—å", anxiety: 30, score: 55, icon: "üò¢" }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 9: –ü–æ—Å–ª–µ–¥–Ω—è—è –¥–≤–µ—Ä—å
                {
                    level: 9,
                    title: "–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–≤–µ—Ä—å",
                    subtitle: "–ü–æ—á—Ç–∏ –∫–æ–Ω–µ—Ü",
                    text: "–í—ã —Å—Ç–æ–∏—Ç–µ –ø–µ—Ä–µ–¥ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–≤–µ—Ä—å—é. –ó–∞ –Ω–µ–π - –≤—ã—Ö–æ–¥ –∏–ª–∏ –Ω–æ–≤–∞—è –ª–æ–≤—É—à–∫–∞? –ì–æ–ª–æ—Å –∏–∑–Ω—É—Ç—Ä–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º –æ—Å—Ç–∞—Ç—å—Å—è. –ó–¥–µ—Å—å –±–µ–∑–æ–ø–∞—Å–Ω–æ. –ó–¥–µ—Å—å –Ω–µ—Ç –±–æ–ª–∏. –ß—Ç–æ –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ?",
                    choices: [
                        { text: "üö™ –û—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å –∏ –≤—ã–π—Ç–∏", anxiety: 35, score: 70, icon: "üö™" },
                        { text: "üè† –û—Å—Ç–∞—Ç—å—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏", anxiety: 20, score: 40, icon: "üè†" },
                        { text: "üîì –í–∑–ª–æ–º–∞—Ç—å –¥–≤–µ—Ä—å —Å–∏–ª–æ–π", anxiety: 60, score: 80, icon: "üîì", dangerous: true },
                        { text: "ü§î –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –≥–æ–ª–æ—Å—É", anxiety: 25, score: 60, icon: "ü§î" }
                    ]
                },
                // –£—Ä–æ–≤–µ–Ω—å 10: –§–∏–Ω–∞–ª
                {
                    level: 10,
                    title: "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ",
                    subtitle: "–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–±–æ—Ä",
                    text: "–í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ - —ç—Ç–æ –±—ã–ª –≤–∞—à —Ä–∞–∑—É–º. –í—Å–µ —Å—Ç—Ä–∞—Ö–∏, –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è - –≤–∞—à–∏. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–Ω—É—Ç—å—Å—è —Å–µ–π—á–∞—Å –∏–ª–∏ –æ—Å—Ç–∞—Ç—å—Å—è –∑–¥–µ—Å—å –Ω–∞–≤—Å–µ–≥–¥–∞, –∏—Å—Å–ª–µ–¥—É—è –≥–ª—É–±–∏–Ω—ã —Å–æ–∑–Ω–∞–Ω–∏—è. –ß—Ç–æ –≤—ã –≤—ã–±–µ—Ä–µ—Ç–µ?",
                    choices: [
                        { text: "‚òÄÔ∏è –ü—Ä–æ—Å–Ω—É—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏", anxiety: 0, score: 100, icon: "‚òÄÔ∏è" },
                        { text: "üåô –û—Å—Ç–∞—Ç—å—Å—è –≤ –≥–ª—É–±–∏–Ω–∞—Ö", anxiety: 70, score: 90, icon: "üåô", dangerous: true },
                        { text: "‚ôæÔ∏è –ù–∞—á–∞—Ç—å –ø—É—Ç—å –∑–∞–Ω–æ–≤–æ", anxiety: 30, score: 80, icon: "‚ôæÔ∏è" },
                        { text: "üé≠ –ü—Ä–∏–Ω—è—Ç—å –æ–±–µ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏", anxiety: 50, score: 120, icon: "üé≠", dangerous: true }
                    ]
                }
            ],

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            init() {
                this.createParticles();
                this.updateUI();
                
                // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–∞–π–ø–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
                this.setupTouchSupport();
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                this.loadProgress();
            },

            // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü
            createParticles() {
                const container = document.getElementById('particles');
                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                    container.appendChild(particle);
                }
            },

            // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
            startGame() {
                this.state.currentLevel = 1;
                this.state.score = 0;
                this.state.anxiety = 0;
                this.state.decisions = 0;
                this.state.currentScenarioIndex = 0;
                this.state.gameActive = true;

                this.showScreen('game-screen');
                this.loadScenario();
                this.updateUI();
                this.playSound('start');
            },

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è
            loadScenario() {
                const scenario = this.scenarios[this.state.currentScenarioIndex];
                
                if (!scenario) {
                    this.endGame();
                    return;
                }

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —É—Ä–æ–≤–Ω–µ
                document.getElementById('level-title').textContent = `–£—Ä–æ–≤–µ–Ω—å ${scenario.level}`;
                document.getElementById('level-subtitle').textContent = scenario.subtitle;
                document.getElementById('scenario-text').textContent = scenario.text;

                // –ü—Ä–æ–≥—Ä–µ—Å—Å
                const progress = (this.state.currentScenarioIndex / this.scenarios.length) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';

                // –°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–±–æ—Ä–æ–≤
                const choicesContainer = document.getElementById('choices');
                choicesContainer.innerHTML = '';

                scenario.choices.forEach((choice, index) => {
                    const choiceBtn = document.createElement('div');
                    choiceBtn.className = 'choice' + (choice.dangerous ? ' dangerous' : '');
                    choiceBtn.innerHTML = `<span class="choice-icon">${choice.icon}</span>${choice.text}`;
                    choiceBtn.onclick = () => this.makeChoice(choice);
                    
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
                    setTimeout(() => {
                        choicesContainer.appendChild(choiceBtn);
                    }, index * 150);
                });

                this.updateUI();
            },

            // –í—ã–±–æ—Ä —Ä–µ—à–µ–Ω–∏—è
            makeChoice(choice) {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                this.state.score += choice.score;
                this.state.anxiety += choice.anxiety;
                this.state.decisions++;

                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç—Ä–µ–≤–æ–≥–∏
                if (this.state.anxiety > 100) this.state.anxiety = 100;
                if (this.state.anxiety < 0) this.state.anxiety = 0;

                // –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
                if (choice.dangerous) {
                    document.getElementById('game-container').classList.add('shake');
                    setTimeout(() => {
                        document.getElementById('game-container').classList.remove('shake');
                    }, 500);
                }

                if (this.state.anxiety > 70) {
                    document.getElementById('game-container').classList.add('darken');
                    setTimeout(() => {
                        document.getElementById('game-container').classList.remove('darken');
                    }, 300);
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                this.checkAchievements();

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
                this.updateUI();

                // –°–ª–µ–¥—É—é—â–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π
                this.state.currentScenarioIndex++;
                this.state.currentLevel = Math.floor(this.state.currentScenarioIndex) + 1;

                // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–º
                setTimeout(() => {
                    this.loadScenario();
                }, 800);

                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                this.saveProgress();

                // –ó–≤—É–∫
                this.playSound('choice');
            },

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI() {
                document.getElementById('current-level').textContent = this.state.currentLevel;
                document.getElementById('score').textContent = this.state.score;
                document.getElementById('decisions').textContent = this.state.decisions;
                document.getElementById('anxiety-fill').style.width = this.state.anxiety + '%';

                // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ —à–∫–∞–ª—ã —Ç—Ä–µ–≤–æ–≥–∏
                const anxietyFill = document.getElementById('anxiety-fill');
                if (this.state.anxiety > 70) {
                    anxietyFill.style.background = 'linear-gradient(90deg, #ff0000, #ff0066)';
                } else if (this.state.anxiety > 40) {
                    anxietyFill.style.background = 'linear-gradient(90deg, #ffaa00, #ff6600)';
                } else {
                    anxietyFill.style.background = 'linear-gradient(90deg, #00ff88, #ffaa00)';
                }
            },

            // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
            endGame() {
                this.state.gameActive = false;
                
                // –†–∞—Å—á—ë—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                let resultTitle = '';
                let resultMessage = '';
                
                if (this.state.anxiety > 80) {
                    resultTitle = 'üò∞ –°–ª–æ–º–ª–µ–Ω —Å—Ç—Ä–∞—Ö–æ–º';
                    resultMessage = '–¢—Ä–µ–≤–æ–≥–∞ –ø–æ–≥–ª–æ—Ç–∏–ª–∞ –≤–∞—Å. –†–∞–∑—É–º –Ω–µ –≤—ã–¥–µ—Ä–∂–∞–ª –∏—Å–ø—ã—Ç–∞–Ω–∏—è. –ù–æ –ø–æ–º–Ω–∏—Ç–µ - –∫–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–µ–ª–∞–µ—Ç –≤–∞—Å —Å–∏–ª—å–Ω–µ–µ.';
                } else if (this.state.score > 600) {
                    resultTitle = 'üèÜ –ú–∞—Å—Ç–µ—Ä —Å–æ–∑–Ω–∞–Ω–∏—è';
                    resultMessage = '–í—ã –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ –≤—Å–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è —Å —á–µ—Å—Ç—å—é! –í–∞—à —Ä–∞–∑—É–º —Å–∏–ª—ë–Ω, –∞ —Ä–µ—à–µ–Ω–∏—è - –º—É–¥—Ä—ã. –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ø—Ä–æ—Å–≤–µ—Ç–ª–µ–Ω–∏—è.';
                } else if (this.state.score > 400) {
                    resultTitle = '‚≠ê –ò—Å–∫–∞—Ç–µ–ª—å –∏—Å—Ç–∏–Ω—ã';
                    resultMessage = '–í—ã —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –∏—Å–ø—ã—Ç–∞–Ω–∏–π. –í–∞—à –ø—É—Ç—å –±—ã–ª –Ω–µ –ª—ë–≥–æ–∫, –Ω–æ –≤—ã –Ω–∞—à–ª–∏ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ö–æ–º –∏ —Ö—Ä–∞–±—Ä–æ—Å—Ç—å—é.';
                } else if (this.state.score > 200) {
                    resultTitle = 'üé≠ –í—ã–∂–∏–≤—à–∏–π';
                    resultMessage = '–í—ã –ø—Ä–æ—à–ª–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ, –Ω–æ –Ω–µ –±–µ–∑ –ø–æ—Ç–µ—Ä—å. –°—Ç—Ä–∞—Ö–∏ –≤—Å—ë –µ—â—ë –ø—Ä–µ—Å–ª–µ–¥—É—é—Ç –≤–∞—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, –≤—ã–±–∏—Ä–∞—è –¥—Ä—É–≥–æ–π –ø—É—Ç—å.';
                } else {
                    resultTitle = 'üå´Ô∏è –ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–π';
                    resultMessage = '–õ–∞–±–∏—Ä–∏–Ω—Ç —Ä–∞–∑—É–º–∞ –æ–∫–∞–∑–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–º. –ù–æ –Ω–µ –æ—Ç—á–∞–∏–≤–∞–π—Ç–µ—Å—å - –∫–∞–∂–¥–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ —É—á–∏—Ç –Ω–∞—Å —á–µ–º—É-—Ç–æ –Ω–æ–≤–æ–º—É.';
                }

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                document.getElementById('result-title').textContent = resultTitle;
                document.getElementById('result-message').textContent = resultMessage;
                document.getElementById('final-score').textContent = this.state.score;
                document.getElementById('final-level').textContent = this.state.currentLevel;
                document.getElementById('final-decisions').textContent = this.state.decisions;
                document.getElementById('final-anxiety').textContent = this.state.anxiety + '%';

                this.showScreen('result-screen');
                this.playSound('end');
            },

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤
            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            },

            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
            restartGame() {
                this.startGame();
            },

            // –í–æ–∑–≤—Ä–∞—Ç –≤ –º–µ–Ω—é
            backToMenu() {
                this.showScreen('menu-screen');
            },

            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞
            showRules() {
                alert(`üéÆ –ü–†–ê–í–ò–õ–ê –ò–ì–†–´:

üìä –¶–µ–ª—å: –ü—Ä–æ–π—Ç–∏ –≤—Å–µ 10 —É—Ä–æ–≤–Ω–µ–π, —Å–æ—Ö—Ä–∞–Ω—è—è —Ä–∞—Å—Å—É–¥–æ–∫

‚≠ê –ë–∞–ª–ª—ã: –ü–æ–ª—É—á–∞–π—Ç–µ –∑–∞ –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—á–µ–º —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–µ–µ - —Ç–µ–º –±–æ–ª—å—à–µ)

üò∞ –¢—Ä–µ–≤–æ–≥–∞: –°–ª–µ–¥–∏—Ç–µ –∑–∞ —à–∫–∞–ª–æ–π! –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç 100% - –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞

üéØ –£—Ä–æ–≤–Ω–∏: –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å - –Ω–æ–≤–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ —Ä–∞–∑—É–º–∞

üí° –°–æ–≤–µ—Ç: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∏ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ - –∫–ª—é—á –∫ –ø–æ–±–µ–¥–µ

üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è: –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –æ—Å–æ–±—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è`);
            },

            // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            showStats() {
                const saved = this.loadProgress();
                if (saved) {
                    alert(`üìä –í–ê–®–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

üéØ –õ—É—á—à–∏–π —É—Ä–æ–≤–µ–Ω—å: ${saved.bestLevel || 1}
‚≠ê –ú–∞–∫—Å–∏–º—É–º –±–∞–ª–ª–æ–≤: ${saved.bestScore || 0}
üéÆ –í—Å–µ–≥–æ –∏–≥—Ä: ${saved.gamesPlayed || 0}
üíé –í—Å–µ–≥–æ —Ä–µ—à–µ–Ω–∏–π: ${saved.totalDecisions || 0}

–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–≥—Ä–∞—Ç—å, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã!`);
                } else {
                    alert('üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É—Å—Ç–∞. –°—ã–≥—Ä–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∏–≥—Ä—É!');
                }
            },

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
            checkAchievements() {
                // –ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ
                if (this.state.decisions === 1) {
                    this.showAchievement('üéØ', '–ü–µ—Ä–≤—ã–π —à–∞–≥', '–í—ã –ø—Ä–∏–Ω—è–ª–∏ –ø–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ');
                }
                
                // –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 100 –±–∞–ª–ª–æ–≤
                if (this.state.score >= 100 && this.state.score < 120) {
                    this.showAchievement('üíØ', '–°–æ—Ç–Ω—è!', '–ù–∞–±—Ä–∞–Ω–æ 100 –±–∞–ª–ª–æ–≤');
                }
                
                // –ù–∏–∑–∫–∞—è —Ç—Ä–µ–≤–æ–≥–∞ –Ω–∞ 5 —É—Ä–æ–≤–Ω–µ
                if (this.state.currentLevel === 5 && this.state.anxiety < 30) {
                    this.showAchievement('üßò', '–ú–∞—Å—Ç–µ—Ä —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è', '–î–µ—Ä–∂–∏—Ç–µ —Ç—Ä–µ–≤–æ–≥—É –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º');
                }
                
                // –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
                if (this.state.anxiety > 80) {
                    this.showAchievement('üò±', '–ù–∞ –≥—Ä–∞–Ω–∏', '–í—ã –∂–∏–≤—ë—Ç–µ –æ–ø–∞—Å–Ω–æ!');
                }
                
                // –°–µ—Ä–µ–¥–∏–Ω–∞ –ø—É—Ç–∏
                if (this.state.currentLevel === 5) {
                    this.showAchievement('üèÉ', '–°–µ—Ä–µ–¥–∏–Ω–∞ –ø—É—Ç–∏', '–ü–æ–ª–æ–≤–∏–Ω–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π –ø–æ–∑–∞–¥–∏');
                }
            },

            // –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
            showAchievement(icon, title, text) {
                const popup = document.getElementById('achievement-popup');
                document.getElementById('achievement-icon').textContent = icon;
                document.getElementById('achievement-title').textContent = title;
                document.getElementById('achievement-text').textContent = text;
                
                popup.classList.add('show');
                
                setTimeout(() => {
                    popup.classList.remove('show');
                }, 4000);

                this.playSound('achievement');
            },

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            saveProgress() {
                const data = {
                    bestLevel: Math.max(this.state.currentLevel, parseInt(localStorage.getItem('bestLevel') || 0)),
                    bestScore: Math.max(this.state.score, parseInt(localStorage.getItem('bestScore') || 0)),
                    gamesPlayed: parseInt(localStorage.getItem('gamesPlayed') || 0) + (this.state.currentScenarioIndex === 0 ? 1 : 0),
                    totalDecisions: parseInt(localStorage.getItem('totalDecisions') || 0) + 1
                };
                
                Object.keys(data).forEach(key => {
                    localStorage.setItem(key, data[key]);
                });
            },

            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            loadProgress() {
                const saved = {
                    bestLevel: parseInt(localStorage.getItem('bestLevel') || 0),
                    bestScore: parseInt(localStorage.getItem('bestScore') || 0),
                    gamesPlayed: parseInt(localStorage.getItem('gamesPlayed') || 0),
                    totalDecisions: parseInt(localStorage.getItem('totalDecisions') || 0)
                };
                
                return saved.gamesPlayed > 0 ? saved : null;
            },

            // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ touch —Å–æ–±—ã—Ç–∏–π
            setupTouchSupport() {
                let touchStartY = 0;
                let touchEndY = 0;
                
                document.addEventListener('touchstart', (e) => {
                    touchStartY = e.changedTouches[0].screenY;
                }, false);
                
                document.addEventListener('touchend', (e) => {
                    touchEndY = e.changedTouches[0].screenY;
                    this.handleSwipe();
                }, false);
            },

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–∞
            handleSwipe() {
                // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
            },

            // –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–ø—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è)
            playSound(type) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∏—Å—å –∑–≤—É–∫–∏
                console.log(`üîä Sound: ${type}`);
            }
        };

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            game.init();
        });

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
        window.addEventListener('beforeunload', (e) => {
            if (game.state.gameActive) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>

